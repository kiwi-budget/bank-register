sudo: required

addons:
  apt:
    packages:
      - git
      - make
      - curl
env:
  global:
    - DOCKER_IMAGE_NAME=cloudposse/charts
services:
  - docker

install:
  - make init
  - sudo make helm:install
  - make helm:repo:add-remote
  - make helm:repo:add-current
  - make docker:login

script:
  - make helm:repo:build REPO_NAME=incubator
  - make helm:repo:build REPO_NAME=stable
  - make helm:repo:build REPO_NAME=demo
  - make helm:repo:index REPO_NAME=incubator
  - make helm:repo:index REPO_NAME=stable
  - make helm:repo:index REPO_NAME=demo
  - make docker:build

after_success:
  - make travis:docker-tag-and-push